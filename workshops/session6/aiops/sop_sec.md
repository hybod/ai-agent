---

# 🛡️ **安全事件处理 SOP（Security Incident Response SOP）**

适用范围：主机安全、数据库安全、账号安全、网络攻击、恶意程序、漏洞利用、配置风险等。
角色：安全团队、运维 SRE、应用负责人、应急响应小组。

---

# 1. 安全告警分级标准

安全告警通常分为 **High / Medium / Low**，对应事件处理的优先级不同。

## 📌 **1.1 高危（High Severity）**

满足以下任意条件：

* 恶意程序 / 木马 / 反弹 Shell
* 暴力破解成功登录
* 内外网敏感端口被入侵尝试并成功
* 重大漏洞被实际利用
* 数据敏感权限被访问
* 关键系统被远控 / 被篡改
* 异常高危操作（删除数据库、创建非法账号）

👉 **需要立即进入应急响应流程（15 分钟内处理）。**

---

## 📌 **1.2 中危（Medium Severity）**

例如：

* 暴力破解攻击但未成功
* 异常流量 / 端口扫描
* 重要系统存在高危漏洞但未被利用
* 非授权访问尝试
* 访问策略不当引发风险
* 非关键业务上的异常进程

👉 **需在 2 小时内处理，需评估是否升级事件。**

---

## 📌 **1.3 低危（Low Severity）**

例如：

* 低危漏洞
* 临时风险配置
* 可能的误报（如工具误检测）
* 弱口令风险但未被利用
* 资产暴露但无入侵行为

👉 **需 24 小时内处理，计划性修复。**

---

# 2. 总体流程图（文字版）

```
收到安全告警
   ↓
判断告警级别（高危/中危/低危）
   ↓
高危？ —— 是 ——> 启动应急响应流程（即时处置）
   ↓                         ↑
中危？ —— 是 ——> 评估影响 + 限制风险 ——┘
   ↓
低危 ——> 纳入安全优化工作（可计划）
```

---

# 3. 各级别告警处理 SOP

---

# 🚨 3.1 高危安全告警处理流程（High Severity）

### 目标：避免损失扩大、阻断攻击链路、保存证据。

## 步骤 1：立即响应（0–15 分钟）

* 进入安全事件频道（Slack/飞书）
* 通知安全负责人与 SRE 值班人员
* 锁定受影响资产（IP/主机容器/账号/数据库）

---

## 步骤 2：隔离与阻断（0–30 分钟）

根据类型采取不同操作：

### **主机被入侵**

* 立即隔离网络：

  * 停止对外流量
  * 禁用高危端口
* 暂停可疑进程，但先做快照或 dump

### **账号被盗用**

* 立即冻结账号、重置密钥、关闭会话
* 开启 MFA

### **数据库异常操作**

* 立刻移除可疑用户
* 锁定 DML 修改
* 检查是否有 DROP/TRUNCATE

### **恶意程序**

* 杀掉对应进程
* 封禁 Hash
* 删除相关文件

---

## 步骤 3：调查与取证（30–90 分钟）

使用工具（例如 Sec-Agent、SIEM、TLS-MCP）：

* 查询攻击源 IP
* 检查异常登录记录
* 检查新增 root/高权限用户
* 分析进程树
* 查看 WebShell、反弹 Shell
* 搜集日志（Web、系统、数据库）
* 快照磁盘以保留取证材料

---

## 步骤 4：修复（90–180 分钟）

按事件类型修复：

* 修复高危漏洞
* 清理恶意程序
* 删除非法账号
* 重建被破坏的系统文件/应用
* 调整安全组、WAF、访问策略
* 进行代码修复（如由漏洞触发）

---

## 步骤 5：验证（180–240 分钟）

* 恢复服务前必须验证：

  * 日志正常
  * 指标正常
  * 没有更多入侵痕迹
  * 新的风控策略生效
* 恢复服务并持续监控 24 小时

---

## 步骤 6：复盘（T+1）

* 产出 RCA（Root Cause Analysis）
* 评估攻击链
* 提出 Action Items（加固措施）
* 安排补丁、加固策略
* 更新 SOP

---

# ⚠️ 3.2 中危安全告警处理流程（Medium Severity）

### 目标：控制风险，避免扩大，判断是否升级事件。

## 步骤 1：确认告警真实性（0–30 分钟）

* 查看相关日志
* 与资产负责人确认行为是否预期
* 检查是否误报

## 步骤 2：采取限制措施（30–60 分钟）

* IP 加入防火墙封禁
* 限制端口暴露
* 短期加固策略（如暂时加限制流量）
* 限制高风险操作

## 步骤 3：漏洞修复 / 策略优化（1–2 小时）

* 修补 CVE
* 调整防火墙、WAF、Agent 策略
* 更新白名单或黑名单
* 清理风险配置

## 步骤 4：评估是否升级为高危

如出现以下情况需升级为高危事件：

* 攻击持续增强（扫描 → 入侵尝试）
* 资产出现异常进程
* 指标大幅度提升（CPU/网络异常流量）
* 检测到登录尝试成功

## 步骤 5：记录与关闭（当天）

* 整理监控数据、日志片段
* 记录处置方式
* 下发优化建议（弱口令、白名单、分权等）

---

# 🔍 3.3 低危安全告警处理流程（Low Severity）

### 目标：计划性修复，不阻塞业务。

## 步骤 1：分类确认（24 小时内）

* 评估资产重要性
* 评估是否误报
* 判断是否需要立即修改

## 步骤 2：纳入安全优化 backlog

常见如下：

* 低危漏洞
* 弱口令提示
* 未使用服务端口暴露
* 无影响的配置偏差
* 日志策略异常

## 步骤 3：计划性处理

1. 合并同类事件
2. 每周处理周期内修复
3. 更新安全策略和配置基线

## 步骤 4：验证并关闭

* 验证风险消失
* 更新巡检列表
* 关闭事件

---

# 4. 常见安全告警与推荐处理方式表

| 告警类型        | 级别 | 推荐操作              |
| ----------- | -- | ----------------- |
| SSH 暴力破解成功  | 高危 | 冻结账号、封禁 IP、开启 MFA |
| 暴力破解失败      | 中危 | 加防火墙限制、提高密码强度     |
| WebShell 检测 | 高危 | 快照取证、隔离主机、清理脚本    |
| 异常高权限操作     | 高危 | 审计账号、移除权限、调查日志    |
| 恶意程序运行      | 高危 | 终止进程、查树、隔离主机      |
| 系统高危漏洞      | 中危 | 打补丁、升级版本          |
| 非关键服务弱口令    | 低危 | 密码策略收敛、修复         |
| 异常端口扫描      | 中危 | 封禁 IP、强化安全组       |
| 数据库暴露端口     | 中危 | 加固网络策略、白名单        |
| 配置不合规       | 低危 | 计划修复              |

---

# 5. 安全事件记录模板（可复制）

```
# Security Incident Record

**事件名称：** XXXXX  
**告警等级：** High / Medium / Low  
**事件时间：** 202X-XX-XX XX:XX  
**涉及资产：** IP/主机/数据库/账号  
**影响范围：** 服务/用户/数据  

## 1. 事件描述
-  
-  

## 2. 分析过程
-  
-  

## 3. 根因（Root Cause）
-  
-  

## 4. 处置措施
-  
-  

## 5. 验证结果
-  

## 6. 后续行动项（Action Items）
-  
-  

**负责人：**  
**完成时间：**  
```

---

